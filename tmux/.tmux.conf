# ============================================
# TMUX CONFIG - NVIM + OPENCODE WORKFLOW
# ============================================

# Prefix key
unbind C-b
set -g prefix C-a           # Ctrl+A: nuevo prefix (en lugar de Ctrl+B)
bind C-a send-prefix        # Ctrl+A Ctrl+A: envía Ctrl+A literal a la aplicación

# Mouse support
set -g mouse on             # Click y scroll con mouse habilitado

# Split panels
bind | split-window -h -c "#{pane_current_path}"  # Ctrl+A |: split vertical (izq/der)
bind - split-window -v -c "#{pane_current_path}"  # Ctrl+A -: split horizontal (arriba/abajo)

# Navegación entre paneles
bind -n C-h select-pane -L  # Ctrl+H: ir al panel izquierdo
bind -n C-j select-pane -D  # Ctrl+J: ir al panel de abajo
bind -n C-k select-pane -U  # Ctrl+K: ir al panel de arriba
bind -n C-l select-pane -R  # Ctrl+L: ir al panel derecho

# Resize paneles
bind -n M-Left resize-pane -L 5   # Alt+←: reducir ancho (mover borde izquierda)
bind -n M-Right resize-pane -R 5  # Alt+→: aumentar ancho (mover borde derecha)
bind -n M-Up resize-pane -U 5     # Alt+↑: reducir altura (mover borde arriba)
bind -n M-Down resize-pane -D 5   # Alt+↓: aumentar altura (mover borde abajo)

# Cerrar panel
unbind x
bind x kill-pane  # Ctrl+A x: cerrar panel actual (sin confirmación)

# Recargar config
bind r source-file ~/.tmux.conf \; display "Config reloaded!"  # Ctrl+A r: recargar tmux.conf

# Apariencia minimalista (zen)
set -g status-style bg=default,fg=white
set -g status-left ""
set -g status-right "#S"  # Solo nombre de sesión
set -g status-position bottom
set -g pane-border-style fg=grey
set -g pane-active-border-style fg=cyan

# Scrollback
set -g history-limit 10000

# Vi mode en copy mode
setw -g mode-keys vi  # Habilitar vim keys en copy mode

# Copy mode keybindings (vi-style)
bind -T copy-mode-vi v send-keys -X begin-selection  # v para iniciar selección
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"  # y para copiar al clipboard
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"  # Enter también copia

# Terminal features: habilitar undercurl y colores RGB
# Usar el TERM de Ghostty en lugar de sobreescribirlo
set -g default-terminal "${TERM}"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours

# Kitty graphics protocol passthrough (requerido para image.nvim)
set -g allow-passthrough on
set -ga update-environment TERM_PROGRAM
